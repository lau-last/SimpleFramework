"use strict";(()=>{var o=class{static{this.listeners=new Map}static addEventToDocument(t,e){this.verifyListener(t,e)||(this.listeners.has(t)||(this.listeners.set(t,new Set),document.addEventListener(t,r=>this.dispatch(t,r))),this.pushListener(t,e))}static verifyListener(t,e){let r=this.listeners.get(t);return r?r.has(e):!1}static pushListener(t,e){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e)}static dispatch(t,e){let r=this.listeners.get(t);if(r)for(let a of r)try{a(e)}catch(s){console.error(`[EventManager] Error in handler "${t}":`,s)}}};var d=class n{constructor(){n.setupDelegation()}static setupDelegation(){n.registerExistingTriggers()}static registerExistingTriggers(t=document){let e=t.querySelectorAll("[data-ajax-trigger]");for(let r of e)n.ensureListenersFor(r.getAttribute("data-ajax-trigger"))}static shouldPreventDefault(t,e){return t==="submit"||t==="click"&&e.tagName==="A"}static createContext(t){let e=n.resolveAjaxUrl(t);if(!e?.url||!e?.method)return null;let r=n.resolveAjaxTarget(t),a=n.resolveAjaxSwap(t),s=n.buildFormData(t),i=n.resolveAjaxSelect(t);return{element:t,url:e.url,method:e.method,targetSelector:r,swapMode:a,formData:s,selectSelector:i}}static performAjax(t){return n.sendRequest(t.url,t.method,t.formData,t.element)}static onEvent(t){let e=t.target;if(!(e instanceof Element))return;let r=t.type,a=`[data-ajax-trigger="${r}"]`,s=e.closest(a);if(!s)return;n.shouldPreventDefault(r,s)&&t.preventDefault();let i=n.createContext(s);if(!i){console.warn("No AJAX URL/method resolved for:",s);return}n.emitEvent(s,"data-ajax:before-request",i),n.handleAjaxEvents(s,"data-ajax-event-before",i),n.performAjax(i).then(l=>{n.emitEvent(s,"data-ajax:on-success",i),n.handleAjaxEvents(s,"data-ajax-event-success",i);let c=n.getTargetElement(i.targetSelector,s),u=n.extractSelectedHtml(l,i.selectSelector);n.applySwap(c,u,i.swapMode)}).catch(()=>{n.emitEvent(s,"data-ajax:on-error",i),n.handleAjaxEvents(s,"data-ajax-event-error",i),console.error("AJAX error:",s);let l=n.getTargetElement(i.targetSelector,s);n.applySwap(l,'<p style="color:red;">Error while loading.</p>',i.swapMode)}).finally(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{n.emitEvent(s,"data-ajax:after-request",i),n.handleAjaxEvents(s,"data-ajax-event-after",i)})})})}static ensureListenersFor(t){t&&(t.includes(" ")||o.addEventToDocument(t,n.onEvent))}static resolveAjaxSwap(t){let e=t.getAttribute("data-ajax-swap");return e||"innerHTML"}static resolveAjaxPost(t){return t.closest("[data-ajax-post]")?.getAttribute("data-ajax-post")||null}static resolveAjaxGet(t){return t.closest("[data-ajax-get]")?.getAttribute("data-ajax-get")||null}static resolveAjaxUrl(t){let e=n.resolveAjaxPost(t),r=n.resolveAjaxGet(t);return!e&&!r?(console.warn("No data-ajax-post or data-ajax-get found for:",t),null):{url:e||r,method:e?"POST":"GET"}}static resolveAjaxTarget(t){let e=t.closest("[data-ajax-target]")?.getAttribute("data-ajax-target");return e||console.warn("No data-ajax-target defined for:",t),e||null}static resolveAjaxSelect(t){return t.closest("[data-ajax-select]")?.getAttribute("data-ajax-select")||null}static resolveAjaxValue(t){return t.closest("[data-ajax-value]")?.getAttribute("data-ajax-value")||null}static extractSelectedHtml(t,e){if(!e)return t;try{let a=new DOMParser().parseFromString(t,"text/html").querySelector(e);return a?a.innerHTML:t}catch{return t}}static getTargetElement(t,e){if(t){let r=document.querySelector(t);if(r)return r;console.warn("Target not found for selector:",t,"\u2014 using source element instead.")}return e}static applySwap(t,e,r){switch(String(r||"innerHTML").toLowerCase()){case"inner":case"innerhtml":t.innerHTML=e;break;case"outer":case"outerhtml":case"replace":t.outerHTML=e;break;default:console.warn("Unknown swap mode:",r,"\u2014 falling back to innerHTML."),t.innerHTML=e}}static buildFormData(t){let e=t.tagName==="FORM"?t:t.closest("form");if(e)return new FormData(e);let r=new FormData,a=t;return a.name&&r.append(a.name,a.value??""),r}static buildRequestOptions(t){return{method:String(t||"GET").toUpperCase(),headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/html"}}}static prepareRequest(t,e,r,a){let s=n.buildRequestOptions(t),i=e,l=n.resolveAjaxValue(a);if(l)try{let c=JSON.parse(l.replace(/'/g,'"'));for(let[u,L]of Object.entries(c))r.append(u,L)}catch{}if(t==="GET"){let c=new URLSearchParams;for(let[u,L]of r.entries())c.append(u,L);i+=(i.includes("?")?"&":"?")+c.toString()}else s.body=r;return{finalUrl:i,options:s}}static sendRequest(t,e,r,a){let{finalUrl:s,options:i}=n.prepareRequest(e,t,r,a);return fetch(s,i).then(l=>{if(!l.ok)throw new Error("Server error: "+l.status);return l.text()})}static emitEvent(t,e,r={}){t.dispatchEvent(new CustomEvent(e,{detail:{...r},bubbles:!0}))}static handleAjaxEvents(t,e,r={}){let a=t.hasAttribute(e)?t:t.closest?.(`[${e}]`);if(!a)return;let s=a.getAttribute(e);if(!s)return;let i=s.split(";").map(l=>l.trim()).filter(Boolean);for(let l of i)try{let c=window[l];typeof c=="function"?c(r,a):new Function("context","element",l)(r,a)}catch(c){console.error(`Error in ${e} -> "${l}"`,c)}}};var m=class n{constructor(){n.init()}static init(){o.addEventToDocument("animationend",n.onAnimationEnd),o.addEventToDocument("click",n.onClick)}static onAnimationEnd(t){let e=t.target;e&&e.matches('[data-js="alert"]')&&e.remove()}static onClick(t){if(!(t instanceof MouseEvent))return;let e=t.target;if(!e||!e.matches(".close"))return;let r=e.closest('[data-js="alert"]');r&&r.remove()}};var v=class n{constructor(){n.init()}static init(){o.addEventToDocument("click",n.onClick)}static onClick(t){if(!(t instanceof MouseEvent))return;let e=t.target;e&&(n.handleClose(e),n.handleOpen(e))}static handleOpen(t){if(!t.matches('[data-js="aside"][data-target]'))return;let e=t.getAttribute("data-target");if(!e)return;let r=document.querySelector(e);r&&(n.isOpen(r)?n.hide(r):n.show(r))}static handleClose(t){if(!t.matches(".close"))return;let e=t.closest("aside, .sidebar-left, .sidebar-right");e&&n.isOpen(e)&&n.hide(e)}static isOpen(t){return t.classList.contains("show")}static show(t){t.classList.add("show")}static hide(t){t.classList.remove("show")}};var f=class n{constructor(){n.init()}static init(){o.addEventToDocument("click",n.onClick)}static onClick(t){if(!(t instanceof MouseEvent))return;let e=t.target;if(!e)return;let r=e.closest('[data-js="collapse"][data-target]');r&&n.handleToggle(r)}static handleToggle(t){let e=t.getAttribute("data-target");if(!e)return;let r=document.querySelector(e);r&&n.toggle(r,t)}static toggle(t,e){if(n.isAnimating(t))return;let r=t.closest(".accordion");r&&n.handleTypeAccordion(r,t,e),t.classList.contains("show")?n.close(t,e):n.open(t,e)}static handleTypeAccordion(t,e,r){if(!t)return;t.getAttribute("data-type")!=="multiple"&&n.closeAllCollapses(t,e,r)}static closeAllCollapses(t,e,r){t.querySelectorAll(".accordion-body.show").forEach(s=>{s!==e&&n.close(s,r)})}static isAnimating(t){return t.dataset.animating==="true"}static open(t,e){t.hidden=!1,e.setAttribute("aria-expanded","true"),t.dataset.animating="true",t.classList.add("show"),n.prepareOpenStyles(t);let r=t.scrollHeight;t.style.height="0px";let a=n.playOpenAnimation(t,r);a.onfinish=()=>{t.style.height="auto",t.style.overflow="visible",delete t.dataset.animating,n.cleanAnimationStyles(t)}}static close(t,e){t.dataset.animating="true";let r=t.scrollHeight;n.prepareCloseStyles(t,r);let a=n.playCloseAnimation(t,r);a.onfinish=()=>{t.style.height="0px",t.classList.remove("show"),t.hidden=!0,e.setAttribute("aria-expanded","false"),delete t.dataset.animating,n.cleanAnimationStyles(t)}}static prepareOpenStyles(t){t.style.overflow="hidden",t.style.height="auto"}static prepareCloseStyles(t,e){t.style.overflow="hidden",t.style.height=`${e}px`}static playOpenAnimation(t,e){return t.animate([{height:"0px"},{height:`${e}px`}],{duration:300,easing:"ease"})}static playCloseAnimation(t,e){return t.animate([{height:`${e}px`},{height:"0px"}],{duration:300,easing:"ease"})}static cleanAnimationStyles(t){t.style.removeProperty("height"),t.style.removeProperty("overflow"),delete t.dataset.animating,t.style.cssText.trim()||t.removeAttribute("style")}};var p=class n{constructor(){n.init()}static init(){o.addEventToDocument("click",n.onClick)}static onClick(t){if(!(t instanceof MouseEvent))return;let e=t.target;e&&(n.handleSwitch(e)||n.handleClose(e)||n.handleOpen(e))}static handleSwitch(t){if(!t.matches('.close[data-js="dialog"][data-target]'))return!1;let e=t.getAttribute("data-target");if(!e)return!0;let r=document.querySelector(e);if(!(r instanceof HTMLDialogElement))return!0;let a=t.closest("dialog");return a&&a!==r?(a.addEventListener("transitionend",()=>n.open(r),{once:!0}),n.close(a),!0):(r.open||n.open(r),!0)}static handleClose(t){if(!t.matches(".close")||t.matches('[data-js="dialog"]'))return!1;let e=t.closest("dialog");return e&&n.close(e),!0}static handleOpen(t){if(!t.matches('[data-js="dialog"][data-target]')||t.matches(".close"))return!1;let e=t.getAttribute("data-target");if(!e)return!0;let r=document.querySelector(e);return r instanceof HTMLDialogElement&&(r.open||n.open(r)),!0}static open(t){n.emitEvent(t,"dialog:beforeOpen",t),t.showModal(),t.classList.add("show"),n.emitEvent(t,"dialog:afterOpen",t)}static close(t){n.emitEvent(t,"dialog:beforeClose",t),t.classList.remove("show"),t.addEventListener("transitionend",()=>{t.close()},{once:!0}),n.emitEvent(t,"dialog:afterClose",t)}static emitEvent(t,e,r){t.dispatchEvent(new CustomEvent(e,{detail:{element:r},bubbles:!0}))}};var E=class n{constructor(){n.init()}static init(){o.addEventToDocument("click",n.onClick)}static onClick(t){if(!(t instanceof MouseEvent))return;let e=t.target;if(e){if(e.matches('[data-js="dropdown"][data-target]')){let r=e.getAttribute("data-target");if(!r)return;let a=document.querySelector(r);if(!a)return;n.closeAllDropdownsExcept(a),n.toggleDropdown(a);return}e.closest(".dropdown-menu.show")||n.closeAllDropdowns()}}static toggleDropdown(t){n.isOpen(t)?n.closeDropdown(t):n.openDropdown(t)}static isOpen(t){return t.classList.contains("show")}static openDropdown(t){n.isOpen(t)||(t.style.display="block",t.offsetHeight,t.classList.add("show"))}static closeDropdown(t){if(!n.isOpen(t))return;t.classList.remove("show");let e=r=>{r.propertyName==="opacity"&&(t.style.display="none",t.removeEventListener("transitionend",e))};t.addEventListener("transitionend",e,{once:!0}),t.classList.remove("show")}static closeAllDropdownsExcept(t){document.querySelectorAll(".dropdown-menu.show").forEach(r=>{r!==t&&n.closeDropdown(r)})}static closeAllDropdowns(){document.querySelectorAll(".dropdown-menu.show").forEach(e=>n.closeDropdown(e))}};var g=class n{constructor(){n.init()}static init(){o.addEventToDocument("submit",n.onSubmit)}static onSubmit(t){let e=t.target;if(!e)return;let r=e.closest("form");r&&r.matches('[data-js="validate"]')&&(r.checkValidity()||(t.preventDefault(),t.stopPropagation()),r.classList.add("validated"))}};var h=class n{constructor(){n.init()}static init(){o.addEventToDocument("click",n.onClick)}static onClick(t){if(!(t instanceof MouseEvent))return;let e=t.target;e&&n.handleTabClick(e)}static handleTabClick(t){if(!t.matches('[data-js="tab"][data-target]'))return;let e=t.parentElement;if(!e)return;let r=n.resolveContent(t);r&&(n.hideAll(e),n.clearActive(e),n.showOne(t,r))}static resolveContent(t){let e=t.getAttribute("data-target");if(!e)return null;let r=document.querySelector(e);return r instanceof HTMLElement?r:null}static hideAll(t){t.querySelectorAll('[data-js="tab"][data-target]').forEach(r=>{let a=n.resolveContent(r);a&&a.classList.remove("show")})}static clearActive(t){t.querySelectorAll('[data-js="tab"][data-target]').forEach(r=>r.classList.remove("active"))}static showOne(t,e){t.classList.add("active"),e.classList.add("show")}};document.addEventListener("DOMContentLoaded",()=>{new d,new m,new v,new f,new p,new E,new g,new h,console.log(o.listeners)});})();
